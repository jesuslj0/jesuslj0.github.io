(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const T of c.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&l(T)}).observe(document,{childList:!0,subtree:!0});function r(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(n){if(n.ep)return;n.ep=!0;const c=r(n);fetch(n.href,c)}})();let a={WAITING:"WAITING",STRETCHING:"STRETCHING",TURNING:"TURNING",WALKING:"WALKING",TRANSITION:"TRANSITION",FALLING:"FALLING"},s,h,u,N;const g=17,G=30;let S,m=[],i=[],f=0,d=0;const W=document.getElementById("game"),e=W.getContext("2d"),M=800,p=375,I=100,y=3,P=4,k=3,O=2,F=2,A=document.getElementById("score"),b=document.getElementById("max-score"),w=document.getElementById("restart"),B=document.getElementById("introduction");function v(){s=a.WAITING,h=void 0,m=[{x:50,w:50}];for(let t=1;t<5;t++)E();u=m[0].x+m[0].w-5,N=0,S=0,i=[{x:m[0].x+m[0].w,length:0,rotation:0}],f=0,A.innerHTML=f,w.style.display="none",localStorage.getItem("maxScore")?(d=localStorage.getItem("maxScore"),b.innerHTML=`Max Score: ${d}`):d=0,H()}v();function E(){const n=m[m.length-1],T=n.x+n.w+40+Math.floor(Math.random()*160),R=20+Math.floor(Math.random()*80);m.push({x:T,w:R})}function C(){m.forEach(({x:t,w:o})=>{e.fillStyle="black",e.fillRect(t,p-I,o,I)})}function X(t,o,r,l,n){e.beginPath(),e.moveTo(t,o+n),e.lineTo(t,o+l-n),e.arcTo(t,o+l,t+n,o+l,n),e.lineTo(t+r-n,o+l),e.arcTo(t+r,o+l,t+r,o+l-n,n),e.lineTo(t+r,o+n),e.arcTo(t+r,o,t+r-n,o,n),e.lineTo(t+n,o),e.arcTo(t,o,t,o+n,n),e.fill()}function K(){e.save(),e.fillStyle="black",e.translate(u-g/2,N+p-I-G/2),X(-g/2,-G/2,g,G-4,5);const t=5;e.beginPath(),e.arc(t,11.5,3,0,Math.PI*2,!1),e.fill(),e.beginPath(),e.arc(-t,11.5,3,0,Math.PI*2,!1),e.fill(),e.beginPath(),e.fillStyle="white",e.arc(5,-7,3,0,Math.PI*2,!1),e.fill(),e.fillStyle="red",e.fillRect(-g/2-1,-12,g+2,4.5),e.beginPath(),e.moveTo(-9,-14.5),e.lineTo(-17,-18.5),e.lineTo(-14,-8.5),e.fill(),e.beginPath(),e.moveTo(-10,-10.5),e.lineTo(-15,-3.5),e.lineTo(-5,-7),e.fill(),e.restore()}function q(){i.forEach(t=>{e.save(),e.translate(t.x,p-I),e.rotate(Math.PI/180*t.rotation),e.lineWidth=2,e.beginPath(),e.moveTo(0,0),e.lineTo(0,-t.length),e.stroke(),e.restore()})}function H(){e.clearRect(0,0,M,p),e.save(),e.translate(-S,0),C(),K(),q(),e.restore()}window.addEventListener("mousedown",function(t){s==a.WAITING&&(s=a.STRETCHING,h=void 0,window.requestAnimationFrame(L))});window.addEventListener("mouseup",function(t){s==a.STRETCHING&&(s=a.TURNING)});w.addEventListener("click",function(t){v()});function x(){const t=i[i.length-1],o=t.x+t.length;return m.find(l=>l.x<o&&o<l.x+l.w)}function L(t){if(!h){h=t,window.requestAnimationFrame(L);return}let o=t-h;switch(s){case a.WAITING:return;case a.STRETCHING:{i[i.length-1].length+=o/y;break}case a.TURNING:{i[i.length-1].rotation+=o/P,i[i.length-1].rotation>=90&&(i[i.length-1].rotation=90,x()&&(f++,A.innerText=f,f>d&&(d=f,localStorage.setItem("maxScore",d.toLocaleString()),b.innerHTML=`Max Score: ${d}`),E()),s=a.WALKING);break}case a.WALKING:{u+=o/k,B.style.display="none";const r=x();if(r){const l=r.x+r.w-5;u>l&&(u=l,s=a.TRANSITION)}else{const l=i[i.length-1].x+i[i.length-1].length;u>l&&(u=l,s=a.FALLING)}break}case a.TRANSITION:{S+=o/O;const r=x();r.x+r.w-S<100&&(i.push({x:r.x+r.w,length:0,rotation:0}),s=a.WAITING);break}case a.FALLING:{N+=o/F,i[i.length-1].rotation<180&&(i[i.length-1].rotation+=o/P),f>d&&localStorage.setItem("maxScore",f.toLocaleString());const r=I+100;if(N>r){w.style.display="block";return}break}}H(),h=t,window.requestAnimationFrame(L)}
