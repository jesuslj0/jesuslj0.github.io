(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const g of s.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&l(g)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();let c={WAITING:"WAITING",STRETCHING:"STRETCHING",TURNING:"TURNING",WALKING:"WALKING",TRANSITION:"TRANSITION",FALLING:"FALLING"},m,T,h,S;const I=17,x=30;let p,f=[],a=[],d=0,u=0;const M=document.getElementById("game"),e=M.getContext("2d"),y=800,G=375,N=100,k=3,A=4,O=3,F=2,B=2,b=document.getElementById("score"),v=document.getElementById("max-score"),P=document.getElementById("restart"),C=document.getElementById("introduction");function E(){for(m=c.WAITING,T=void 0,f=[{x:50,w:50}],i=1;i<5;i++)H();h=f[0].x+f[0].w-5,S=0,p=0,a=[{x:f[0].x+f[0].w,length:0,rotation:0}],d=0,b.innerHTML=d,P.style.display="none",localStorage.getItem("maxScore")?(u=localStorage.getItem("maxScore"),v.innerHTML=`Max Score: ${u}`):u=0,R()}E();function H(){const n=f[f.length-1],g=n.x+n.w+40+Math.floor(Math.random()*160),W=20+Math.floor(Math.random()*80);f.push({x:g,w:W})}function X(){f.forEach(({x:t,w:o})=>{e.fillStyle="black",e.fillRect(t,G-N,o,N)})}function K(t,o,r,l,n){e.beginPath(),e.moveTo(t,o+n),e.lineTo(t,o+l-n),e.arcTo(t,o+l,t+n,o+l,n),e.lineTo(t+r-n,o+l),e.arcTo(t+r,o+l,t+r,o+l-n,n),e.lineTo(t+r,o+n),e.arcTo(t+r,o,t+r-n,o,n),e.lineTo(t+n,o),e.arcTo(t,o,t,o+n,n),e.fill()}function q(){e.save(),e.fillStyle="black",e.translate(h-I/2,S+G-N-x/2),K(-I/2,-x/2,I,x-4,5);const t=5;e.beginPath(),e.arc(t,11.5,3,0,Math.PI*2,!1),e.fill(),e.beginPath(),e.arc(-t,11.5,3,0,Math.PI*2,!1),e.fill(),e.beginPath(),e.fillStyle="white",e.arc(5,-7,3,0,Math.PI*2,!1),e.fill(),e.fillStyle="red",e.fillRect(-I/2-1,-12,I+2,4.5),e.beginPath(),e.moveTo(-9,-14.5),e.lineTo(-17,-18.5),e.lineTo(-14,-8.5),e.fill(),e.beginPath(),e.moveTo(-10,-10.5),e.lineTo(-15,-3.5),e.lineTo(-5,-7),e.fill(),e.restore()}function U(){a.forEach(t=>{e.save(),e.translate(t.x,G-N),e.rotate(Math.PI/180*t.rotation),e.lineWidth=2,e.beginPath(),e.moveTo(0,0),e.lineTo(0,-t.length),e.stroke(),e.restore()})}function R(){e.clearRect(0,0,y,G),e.save(),e.translate(-p,0),X(),q(),U(),e.restore()}window.addEventListener("mousedown",function(t){m==c.WAITING&&(m=c.STRETCHING,T=void 0,window.requestAnimationFrame(w))});window.addEventListener("mouseup",function(t){m==c.STRETCHING&&(m=c.TURNING)});P.addEventListener("click",function(t){E()});function L(){const t=a[a.length-1],o=t.x+t.length;return f.find(l=>l.x<o&&o<l.x+l.w)}function w(t){if(!T){T=t,window.requestAnimationFrame(w);return}let o=t-T;switch(m){case c.WAITING:return;case c.STRETCHING:{a[a.length-1].length+=o/k;break}case c.TURNING:{a[a.length-1].rotation+=o/A,a[a.length-1].rotation>=90&&(a[a.length-1].rotation=90,L()&&(d++,b.innerText=d,d>u&&(u=d,localStorage.setItem("maxScore",u.toLocaleString()),v.innerHTML=`Max Score: ${u}`),H()),m=c.WALKING);break}case c.WALKING:{h+=o/O,C.style.display="none";const r=L();if(r){const l=r.x+r.w-5;h>l&&(h=l,m=c.TRANSITION)}else{const l=a[a.length-1].x+a[a.length-1].length;h>l&&(h=l,m=c.FALLING)}break}case c.TRANSITION:{p+=o/F;const r=L();r.x+r.w-p<100&&(a.push({x:r.x+r.w,length:0,rotation:0}),m=c.WAITING);break}case c.FALLING:{S+=o/B,a[a.length-1].rotation<180&&(a[a.length-1].rotation+=o/A),d>u&&localStorage.setItem("maxScore",d.toLocaleString());const r=N+100;if(S>r){P.style.display="block";return}break}}R(),T=t,window.requestAnimationFrame(w)}
